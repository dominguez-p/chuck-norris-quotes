<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="all-campings.html"> 

<dom-module id="new-camping">
    <template>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style>

        </style>
        <iron-ajax
            id="createCampingAjx"
            url='https://api.mlab.com/api/1/databases/yelpcamp2017/collections/campgrounds'
            params='{"apiKey":"qpnQ2vCoFR8HMb_cf0vFfyP0B99yUKGL"}'
            method="POST"
            content-type="application/json"
            handle-as="text"
            on-response="handleUserResponse"
            on-error="handleUserError">
        </iron-ajax>

        <div class="row">
                <h1 style="text-align: center">Create a new campground</h1>
                <div style="width: 30%; margin: 25px auto">
                    <!-- <form action="/campgrounds" method="POST"> -->
                        <div class="form-group">
                            <iron-input bind-value="{{newCampingObj.nombre}}">
                                <input class="form-control" type="text" name="name" placeholder="name">
                            </iron-input>
                        </div>
                        <div class="form-group">
                            <iron-input bind-value="{{newCampingObj.price}}">
                                <input class="form-control" type="number" name="price" placeholder="price" min="0.01" step="0.01">
                            </iron-input>
                        </div>
                        <div class="form-group">
                            <iron-input  bind-value="{{newCampingObj.image}}">
                                <input class="form-control" type="text" name="image" placeholder="image url">    
                            </iron-input>
                        </div>
                        <div class="form-group">
                            <iron-input bind-value="{{newCampingObj.description}}">
                                <input class="form-control" name="description" placeholder="description"></input>    
                            </iron-input>
                        </div>                
                        <div class="form-group">
                            <button on-click="createCampimg" class="btn btn-lg btn-control btn-block btn-primary">Submit!</button>    
                        </div>
                    <!-- </form> -->
                    <a href="/all-campings">Go Back</a>              
                </div>
            </div>
    </template>

    <script>
        class MyView6 extends Polymer.Element {
        static get is() { return 'new-camping'; }
        static get properties() {
            return {
                newCampingObj: {
                    type: Object,
                    value: {}
                  },
                }
            }
            _setReqBody() {
                this.$.createCampingAjx.body = this.newCampingObj;
            }
            createCampimg(){
                console.log("funcion getPosts" + this.newCampingObj.nombre);    
                var newCampingObj = {
                    name: this.newCampingObj.nombre,
                    price: this.newCampingObj.price,
                    image: this.newCampingObj.image,
                    description: this.newCampingObj.description,
                    author: "An√≥nimo"
                };
                this._setReqBody();
                this.$.createCampingAjx.generateRequest();
            }
            handleUserResponse(event) {
                console.log("Camping creado!")
                // var response = JSON.parse(event.detail.response);
                // console.log("crear camping= " + response);
            }
            handleUserError(event) {
                this.error = event.detail.request.xhr.response;
                console.log(this.error);
            }
        }

        window.customElements.define(MyView6.is, MyView6);

    </script>
</dom-module>
    
